<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>TeacherAssistant — Developer Notes</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: Segoe UI, Roboto, Arial, sans-serif; line-height:1.5; margin:24px; color:#111 }
    h1,h2 { color:#0b5; }
    section { margin-bottom:18px; border-left:4px solid #eee; padding-left:12px }
    .meta { color:#666; font-size:0.9em }
    ul { margin:8px 0 12px 20px }
    .todo { color:#b33 }
    pre { background:#f7f7f7; padding:8px; border-radius:4px; overflow:auto }

.tree {
    padding: 20px;
    font-family: Arial, sans-serif;
}

/* Remove bullets */
.tree ul {
    list-style: none;
    margin: 0;
    padding-left: 25px;   /* indentation */
    position: relative;
}

/* Vertical line between siblings */
.tree ul::before {
    content: "";
    position: absolute;
    top: 0;
    left: 12px;  /* vertical spine position */
    width: 0;
    height: 100%;
    border-left: 2px solid #777;
}

/* Node container */
.tree li {
    margin: 0;
    padding: 10px 0 0 15px;
    position: relative;
}

/* Horizontal connector — moved left more */
.tree li::before {
    content: "";
    position: absolute;
    top: 25px;
    left: -13px;   /* <-- shifted more to the left */
    width: 30px;   /* reaches the node perfectly */
    border-top: 2px solid #777;
}

/* Remove the lower part of the vertical line for last child */
.tree li:last-child::after {
    content: "";
    position: absolute;
    left: 12px;
    top: 16px;
    height: 100%;
    width: 2px;
    background: white;
}

/* Node box */
.node {
    display: inline-block;
    background: #f0f0f0;
    padding: 6px 10px;
    border: 1px solid #aaa;
    border-radius: 6px;
    font-size: 14px;
}
  </style>
</head>
<body>
  <h1>TeacherAssistant — Developer Notes</h1>
  <p class="meta">Purpose: short developer-facing notes describing each primary UI page, its responsibilities, key widgets, expected data flow, and integration points.</p>

  <section>
    <h2>Main Window / Dashboard</h2>
    <p>Role: central navigation hub and summary area. Provides quick access to recent resources, student alerts, and active tasks.</p>
    <ul>
      <li>Key widgets: menu bar, navigation pane, quick-actions toolbar, summary cards.</li>
      <li>Data sources: app settings, recent activity cache, notification store.</li>
      <li>Actions: open resource manager, open student list, start new test, open settings.</li>
      <li>Notes: keep dashboard updates lightweight (cached summaries). Avoid heavy DB queries on load.</li>
    </ul>
  </section>

  <section>
    <h2>Resource Manager / Library</h2>
    <p>Role: browse, filter and organize educational resources (PDF, images, HTML, LaTeX).</p>
    <ul>
      <li>Key widgets: resource tree/list, search box, filter chips, import/export actions.</li>
      <li>Data flow: loads metadata from resources DB/JSON; preview requests open editor or viewer.</li>
      <li>Edge cases: large PDFs — use streaming preview; corrupted files — show validation error and allow re-import.</li>
      <li>TODO: add tagging and bulk-rename operations.</li>
    </ul>
  </section>

  <section>
    <h2>Resource Editor / Viewer</h2>
    <p>Role: create and edit resource content. Supports multiple content types and embedded media.</p>
    <ul>
      <li>Modes: Edit (rich/markup), Preview (rendered HTML/PDF/image), Export (to file/PDF).</li>
      <li>Supported content: plain text, HTML, Markdown (if present), LaTeX snippets, images, embedded PDFs.</li>
      <li>Saving: metadata + binary storage model. Autosave optional — configurable in settings.</li>
      <li>Notes: isolate processing (LaTeX compile, PDF rendering) into background tasks to keep UI responsive.</li>
    </ul>
  </section>

  <section>
    <h2>Test / Quiz Builder</h2>
    <p>Role: assemble quizzes and formal exams from resources and question bank.</p>
    <ul>
      <li>Key widgets: question palette, layout templates (quiz/exam), numbering/mode controls, export formats (PDF/HTML).</li>
      <li>Data: questions may reference resource attachments; store exam templates separately.</li>
      <li>Important: ensure export preserves RTL/LTR layout and math rendering (LaTeX).</li>
    </ul>
  </section>

  <section>
    <h2>Student List</h2>
    <p>Role: list of students with quick actions and filters.</p>
    <ul>
      <li>Key widgets: search, sort, group filters, quick profile card.</li>
      <li>Data: minimal list loaded first; details loaded on demand to reduce startup cost.</li>
      <li>Privacy: sensitive fields should be masked/controlled by permissions.</li>
    </ul>
  </section>
  <section>
      <h2>Student List class (<code>StudentListPage</code>)</h2>
      <p>
        <strong>File:</strong> <code>TeacherAssistant/views/Pages.py</code><br>
        <strong>Class:</strong> <code>StudentListPage(QWidget)</code><br>
        
      </p>
      <strong>Layout structure:</strong><br>
      <div class="tree">
    <ul>
        <li><span class="node">Root QWidget</span>
            <ul>
                <li><span class="node">QVBoxLayout (main_layout)</span>
                    <ul>
                        <li><span class="node">QWidget (header widget)</span>
                            <ul>
                                <li><span class="node">QHBoxLayout (header_layout)</span>
                                    <ul>
                                        <li><span class="node">QLabel (page_title)</span></li>
                                        <li><span class="node">QLineEdit (search_input)</span></li>
                                        <li><span class="node">QComboBox (class_filter_combo)</span></li>
                                        <li><span class="node">QPushButton (hamburger_btn)</span></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li><span class="node">QTableWidget (tableWidget)</span></li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</div>
      <ul>
        <li><strong>Purpose:</strong> Central page for managing and viewing all students. Supports searching, filtering by group, importing/exporting, and quick actions for each student.</li>
        <li><strong>Main Widgets:</strong>
          <ul>
            <li>Header: Title, search box, group filter combo, options menu (☰)</li>
            <li><code>QTableWidget</code>: Displays students with columns for photo, info, address/contact, and last behavioral note</li>
          </ul>
        </li>
        <li><strong>Data Flow:</strong>
          <ul>
            <li>Loads group list from <code>groups</code> table for filtering</li>
            <li>Loads student data (with last behavioral note) from <code>personal_info</code> and <code>observed_behaviours</code> tables</li>
            <li>Supports CSV import (with strict column mapping)</li>
          </ul>
        </li>
        <li><strong>Key Features:</strong>
          <ul>
            <li>Search students by any visible field (search box highlights and scrolls to match)</li>
            <li>Filter by group (combo box, dynamically loaded)</li>
            <li>Import students from CSV (shows format warning, supports "don't show again" option)</li>
            <li>Quick actions per student (menu button in each row): assign edu-item, view learning progress, edit personal info, write behavioral note, remove from group/database</li>
            <li>Bulk/group actions from header menu: add student, import CSV, assign edu-item to group/selected, group students, manage groups</li>
          </ul>
        </li>
        <li><strong>Integration Points:</strong>
          <ul>
            <li>Uses <code>viewModels.ClassroomGroupViewModel</code> for group data</li>
            <li>Uses <code>Widgets.EduItemWidget</code> and <code>Widgets.ObservedBehaviourWidget</code> for custom row and dialog UIs</li>
            <li>Uses <code>PopupNotifier</code> for user feedback</li>
            <li>Relies on <code>settings_manager</code> for persistent options (e.g., CSV warning)</li>
          </ul>
        </li>
        <li><strong>Behavioral Notes:</strong>
          <ul>
            <li>Behavioral notes are shown in the last column, with scrollable area for long notes</li>
            <li>Adding/editing notes opens a dialog with <code>QTextEdit</code> for input</li>
          </ul>
        </li>
        <li><strong>Photo Handling:</strong>
          <ul>
            <li>Photos are stored as bytea in DB, converted to <code>QPixmap</code> for display</li>
            <li>Photo box is fixed size (80x110 px), "No Photo" shown if missing</li>
          </ul>
        </li>
        <li><strong>Best Practices & Notes:</strong>
          <ul>
            <li>All DB access via <code>TeacherAssistant.db_connection.cursor()</code></li>
            <li>UI updates (e.g., table refresh) are done after DB changes</li>
            <li>Column mapping for CSV import is case-sensitive and must match exactly</li>
            <li>Group management dialogs are modular and reusable</li>
            <li>All destructive actions (delete student, remove from DB) require confirmation</li>
          </ul>
        </li>
        <li><strong>Extensibility:</strong>
          <ul>
            <li>To add new columns: update <code>load_students</code> and table header setup</li>
            <li>To add new actions: extend <code>create_menu_btn</code> for per-student actions, or <code>create_more_option_menu</code> for bulk actions</li>
            <li>To support new import formats: update <code>load_from_csv</code> and mapping logic</li>
          </ul>
        </li>
        <li><strong>Potential Issues:</strong>
          <ul>
            <li>Large student lists may impact performance; consider pagination or lazy loading if needed</li>
            <li>CSV import is strict; user errors in column names will silently skip columns</li>
            <li>Photo scaling ignores aspect ratio (may distort images)</li>
          </ul>
        </li>
        <li><strong>Testing:</strong>
          <ul>
            <li>Test with/without photos, with/without behavioral notes</li>
            <li>Test CSV import with correct and incorrect headers</li>
            <li>Test group assignment and removal flows</li>
          </ul>
        </li>
      </ul>
      <p class="meta">Last updated: Nov 2025</p>
      <pre>
  # Example: Adding a new column to the student table
  # 1. Update self.tableWidget.setColumnCount and setHorizontalHeaderLabels
  # 2. Update load_students to fetch and display the new data
  # 3. Update CSV import mapping if needed
      </pre>
    </section>

  <section>
    <h2>Student Detail / Profile</h2>
    <p>Role: detailed student information and event history (behavioral events, submissions).</p>
    <ul>
      <li>Sections: personal info, contact, group membership, events log, assigned tests.</li>
      <li>Actions: add event, assign test, export record, upload files.</li>
      <li>Notes: keep file attachments in per-student folder; consider quota and cleanup policy.</li>
    </ul>
  </section>

  <section>
    <h2>Settings</h2>
    <p>Role: application configuration (theme, fonts, language, LaTeX settings, storage paths).</p>
    <ul>
      <li>Key options: Theme selection, font selection, RTL/LTR toggle, default export paths, DB connection (Postgres) settings.</li>
      <li>Persistence: settings.json in %LOCALAPPDATA%/MyJobAssistant/ — validate schema on load.</li>
      <li>Note: provide a "Reset to defaults" and "Export/Import settings" feature for support scenarios.</li>
    </ul>
  </section>

  <section>
    <h2>About / Help</h2>
    <p>Role: version, license, credits and links to documentation/support.</p>
    <ul>
      <li>Include app version, license summary (link to LICENSE file), and a link to this developer comments document.</li>
    </ul>
  </section>

  <section>
    <h2>General Developer Notes</h2>
    <ul>
      <li>Keep long-running operations off the UI thread (use QThread or asyncio worker pattern).</li>
      <li>All file-system paths should be resolved using app state helpers (state.setup_app_directories()).</li>
      <li>Use a single source of truth for i18n strings to ease localization.</li>
      <li class="todo">TODO: Add integration test checklist for each page (navigation, basic CRUD, export).</li>
    </ul>
  </section>

  <footer class="meta">Generated: Developer page comments — place near docs/ for quick reference.</footer>
</body>
</html>